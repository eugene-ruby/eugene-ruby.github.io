---
layout: post
subtitle: <div id="terminal"></div>
title:  "üìû –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–æ–≤ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≤ Ruby: send, __send__ –∏ public_send"
date:   2025-04-22 12:00:00 +0300
rate: 4
tags: Ruby,–º–µ—Ç–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ,—Ä–µ—Ñ–ª–µ–∫—Å–∏—è,–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π-–≤—ã–∑–æ–≤
version: 3.2.2
categories:
   - ruby
hero_image: /images/posts/32.jpg
hero_darken: true
toc: true
menubar_toc: true
---

–ò–Ω–æ–≥–¥–∞ –≤ Ruby –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –º–µ—Ç–æ–¥, –∏–º—è –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ –¥–æ –º–æ–º–µ–Ω—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ –∏–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–ª–∞–≥–∏–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã. –í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —Ä–∞–∑–±–µ—Ä—ë–º —Ç—Ä–∏ —Å–ø–æ—Å–æ–±–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–∑–æ–≤–∞ –º–µ—Ç–æ–¥–æ–≤: `send`, `__send__` –∏ `public_send`, –∏—Ö —Ä–∞–∑–ª–∏—á–∏—è –∏ –ø–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏.

---

## üß† –¢–µ–æ—Ä–∏—è: –∑–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –ø–∏—à–µ—Ç–µ:
```ruby
user.name # => "–ê–Ω–Ω–∞"
```
–ù–æ —á—Ç–æ, –µ—Å–ª–∏ –∏–º—è –º–µ—Ç–æ–¥–∞ (`:name`) –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, API –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥–∞? –í–æ—Ç –≥–¥–µ –Ω–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥—è—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –≤—ã–∑–æ–≤—ã.

---

## üîß 1. `send` ‚Äî "—à–≤–µ–π—Ü–∞—Ä—Å–∫–∏–π –Ω–æ–∂"

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**  
–í—ã–∑—ã–≤–∞–µ—Ç –ª—é–±–æ–π –º–µ—Ç–æ–¥ –æ–±—ä–µ–∫—Ç–∞, –≤–∫–ª—é—á–∞—è –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ.

```ruby
class User
  private
  def secret_code
    "123-456"
  end
end

user = User.new
user.send(:secret_code) # => "123-456" (–Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ private!)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –í —Ç–µ—Å—Ç–∞—Ö (–Ω–æ –ª—É—á—à–µ `allow_any_instance_of`)
- –ü—Ä–∏ –≥–ª—É–±–æ–∫–æ–π —Ä–∞–±–æ—Ç–µ —Å –º–µ—Ç–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –í DSL-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö

**–û–ø–∞—Å–Ω–æ—Å—Ç—å:**  
–ù–∞—Ä—É—à–∞–µ—Ç –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—é. –ú–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å –ª–æ–≥–∏–∫—É –∫–ª–∞—Å—Å–∞.

---

## üõ° 2. `__send__` ‚Äî "–∑–∞—â–∏—â—ë–Ω–Ω—ã–π –±—Ä–∞—Ç"

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**  
–¢–æ –∂–µ, —á—Ç–æ `send`, –Ω–æ –∑–∞—â–∏—â—ë–Ω –æ—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

```ruby
class Hacker
  def send(*)
    "–í–∑–ª–æ–º–∞–Ω–æ!"
  end
end

obj = Hacker.new
obj.send(:object_id)  # => "–í–∑–ª–æ–º–∞–Ω–æ!"
obj.__send__(:object_id) # => 70353864381040 (—Ä–µ–∞–ª—å–Ω—ã–π ID)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ö–æ–≥–¥–∞ –µ—Å—Ç—å —Ä–∏—Å–∫, —á—Ç–æ –∫—Ç–æ-—Ç–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏–ª `send`
- –í –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ–º –∫–æ–¥–µ

**–§–∏—à–∫–∞:**  
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Ruby (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `method_missing`).

---

## üîí 3. `public_send` ‚Äî "–≤–µ–∂–ª–∏–≤—ã–π –≥–æ—Å—Ç—å"

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**  
–í—ã–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã.

```ruby
class BankAccount
  private
  def balance
    @balance
  end
end

account = BankAccount.new
account.public_send(:balance) # => NoMethodError
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –≤–≤–æ–¥–æ–º
- –í API-–∫–ª–∏–µ–Ω—Ç–∞—Ö
- –ö–æ–≥–¥–∞ –≤–∞–∂–Ω–æ —Å–æ–±–ª—é–¥–∞—Ç—å –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—é

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**  
–ù–µ –≤—ã–∑–æ–≤–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –æ—á–µ–Ω—å –ø–æ–ø—Ä–æ—Å–∏—Ç—å.

---

## üéØ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã

### 1. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤ Rails
```ruby
# –í–º–µ—Å—Ç–æ:
case action
when "show" then render_show
when "edit" then render_edit
end

# –ú–æ–∂–Ω–æ:
public_send("render_#{action}") if respond_to?("render_#{action}")
```

### 2. –ü–ª–∞–≥–∏–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
```ruby
plugins = [:twitter, :facebook]
plugins.each { |name| public_send("connect_#{name}") }
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ (–∞–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω, –Ω–æ –∏–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ)
```ruby
describe "#calculate_tax" do
  it "returns correct value" do
    expect(calculator.send(:calculate_tax, 100)).to eq(20)
  end
end
```

---

## ‚ö†Ô∏è –û–ø–∞—Å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ ‚Üí send**  
   ```ruby
   # –£—è–∑–≤–∏–º–æ—Å—Ç—å!
   params[:action] = "destroy_all"
   model.send(params[:action])
   ```

2. **–ß—Ä–µ–∑–º–µ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞—è—Ö**  
   ```ruby
   # –ü–ª–æ—Ö–æ:
   user.send(:name)
   
   # –•–æ—Ä–æ—à–æ:
   user.name
   ```

3. **–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ respond_to?**  
   –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ:
   ```ruby
   if user.respond_to?(method_name)
     user.public_send(method_name)
   end
   ```

---

## üé§ –ß—Ç–æ —Å–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏

> ‚Äî –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `send` –∏ `public_send`?

‚Äî `send` –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ª—é–±–æ–π –º–µ—Ç–æ–¥, –≤–∫–ª—é—á–∞—è –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ, —á—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—é. `public_send` ‚Äî —Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–µ, —á—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ. –ê `__send__` ‚Äî —ç—Ç–æ –∑–∞—â–∏—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è `send` –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –µ–≥–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏.

---

## üßæ –í—ã–≤–æ–¥

| –ú–µ—Ç–æ–¥         | –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã? | –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å |
|---------------|-------------------|---------------------------|--------------|
| `send`        | –î–∞                | –ù–µ—Ç                       | –ù–∏–∑–∫–∞—è       |
| `__send__`    | –î–∞                | –î–∞                        | –°—Ä–µ–¥–Ω—è—è      |
| `public_send` | –ù–µ—Ç               | –ù–µ—Ç                       | –í—ã—Å–æ–∫–∞—è      |

**–ó–æ–ª–æ—Ç–æ–µ –ø—Ä–∞–≤–∏–ª–æ:**  
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `public_send` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏, `__send__` ‚Äî –∫–æ–≥–¥–∞ –≤–∞–∂–Ω–æ –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –∞ –æ–±—ã—á–Ω—ã–π `send` ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏ –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏ (–∏ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º "–ø–æ—á–µ–º—É —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ").
