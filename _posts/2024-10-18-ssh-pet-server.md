---
layout: post
subtitle: <div id="terminal"></div>
title: "SSH ‚Äî —ç—Ç–æ —Ç–≤–æ–π –≤–æ–ª—à–µ–±–Ω—ã–π –∫–ª—é—á –∫ —Å–µ—Ä–≤–µ—Ä—É"
date:   2024-10-18 12:00:00 +0300
rate: 1
tags: SSH, Pet, VPS
version: A9X
categories:
  - pet
  - ruby
hero_image: /images/posts/rsa-d25519.jpg
hero_darken: true
toc: true
menubar_toc: true
---
SSH ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–ø–æ—Å–æ–± –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É. –≠—Ç–æ —Ç–≤–æ–π —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø—Ä–æ–ø—É—Å–∫ –≤ –º–∏—Ä DevOps, –≥–¥–µ –ø–∞—Ä–æ–ª–∏ ‚Äî –≤—á–µ—Ä–∞—à–Ω–∏–π –¥–µ–Ω—å, –∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø–∞—Ä—ã —Ñ–∞–π–ª–æ–≤ –≤ `~/.ssh`. –í —Å—Ç–∞—Ç—å–µ —Ä–∞–∑–±–µ—Ä—ë–º, –∫–∞–∫ –∑–∞ 5 –º–∏–Ω—É—Ç —Å–æ–∑–¥–∞—Ç—å –∫–ª—é—á, –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –∑–∞–±—ã—Ç—å –æ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö –≤–≤–æ–¥–∞—Ö –ø–∞—Ä–æ–ª–µ–π.

---

## üîê –ü–æ—á–µ–º—É SSH-–∫–ª—é—á–∏, –∞ –Ω–µ –ø–∞—Ä–æ–ª–∏?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å: —Ç—ã –ø–æ–¥–∫–ª—é—á–∞–µ—à—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É —Å Rails-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º. –í–∞—Ä–∏–∞–Ω—Ç—ã:
- **–ü–∞—Ä–æ–ª—å**: –∫–∞–∂–¥—ã–π —Ä–∞–∑ –≤–≤–æ–¥–∏—Ç—å `my_super_secure_password_123`, —Ä–∏—Å–∫ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞.
- **SSH-–∫–ª—é—á**: –æ–¥–∏–Ω —Ñ–∞–π–ª –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ ‚Äî –∏ –≤—Ö–æ–¥ –∑–∞ —Å–µ–∫—É–Ω–¥—É –±–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤.

SSH-–∫–ª—é—á ‚Äî —ç—Ç–æ:
- **–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á** (—Ç–æ–ª—å–∫–æ —É —Ç–µ–±—è) ‚Äî –∫–∞–∫ –æ—Ç–ø–µ—á–∞—Ç–æ–∫ –ø–∞–ª—å—Ü–∞.
- **–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á** (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ) ‚Äî –∑–∞–º–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —ç—Ç–∏–º –æ—Ç–ø–µ—á–∞—Ç–∫–æ–º.

---

## üõ† –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞: RSA –∏–ª–∏ ed25519?

–û—Ç–∫—Ä–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –≤–≤–µ–¥–∏:

```bash
ssh-keygen -t ed25519 -C "your_email@example.com"
```

**–ü–æ—á–µ–º—É ed25519?**
- –ë—ã—Å—Ç—Ä–µ–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ —Å—Ç–∞—Ä–æ–≥–æ RSA.
- –ö–æ—Ä–æ—á–µ –∫–ª—é—á (–Ω–µ—Ç —ç—Ç–∏—Ö `id_rsa.pub` –Ω–∞ 2 —ç–∫—Ä–∞–Ω–∞).
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö (Ubuntu 20.04+, macOS 10.12+).

**–ï—Å–ª–∏ –Ω—É–∂–µ–Ω RSA** (–¥–ª—è —Å—Ç–∞—Ä—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤):

```bash
ssh-keygen -t rsa -b 4096 -C "backup_key@example.com"
```

---

## üìÇ –ì–¥–µ –ª–µ–∂–∞—Ç –∫–ª—é—á–∏?

–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
- **–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á**: `~/.ssh/id_ed25519` (–Ω–∏–∫–æ–º—É –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å!).
- **–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á**: `~/.ssh/id_ed25519.pub` (–º–æ–∂–Ω–æ —Ä–∞–∑–¥–∞–≤–∞—Ç—å).

–ü—Ä–∏–º–µ—Ä –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞:
```
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJu7X... your_email@example.com
```

---

## üö™ –î–æ–±–∞–≤–ª—è–µ–º –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä

### –í–∞—Ä–∏–∞–Ω—Ç 1: –í—Ä—É—á–Ω—É—é (–µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä —É–∂–µ –µ—Å—Ç—å)
1. –°–∫–æ–ø–∏—Ä—É–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –≤ –±—É—Ñ–µ—Ä:
   ```bash
   cat ~/.ssh/id_ed25519.pub | pbcopy  # macOS
   cat ~/.ssh/id_ed25519.pub | xclip    # Linux
   ```
2. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
   ```bash
   mkdir -p ~/.ssh
   echo "–í–ê–®_–ö–õ–Æ–ß" >> ~/.ssh/authorized_keys
   chmod 600 ~/.ssh/authorized_keys
   ```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–¥–ª—è –Ω–æ–≤–æ–≥–æ VPS)
```bash
ssh-copy-id -i ~/.ssh/id_ed25519.pub user@server_ip
```

---

## üîå –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –±–µ–∑ –ø–∞—Ä–æ–ª—è

–¢–µ–ø–µ—Ä—å –ø—Ä–æ—Å—Ç–æ:
```bash
ssh user@server_ip
```

**–ï—Å–ª–∏ –∫–ª—é—á –Ω–µ RSA –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**:
```bash
ssh -i ~/.ssh/id_ed25519 user@server_ip
```

---

## üß© –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Ruby-–ø—Ä–æ–µ–∫—Ç–∞–º–∏

### 1. Capistrano
–î–æ–±–∞–≤—å –≤ `deploy.rb`:
```ruby
set :ssh_options, keys: %w(~/.ssh/id_ed25519), forward_agent: true
```

### 2. Git over SSH
–î–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤:
```bash
git clone git@github.com:user/repo.git
```

---

## üí• –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω—ã

| –û—à–∏–±–∫–∞                          | –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è                     |
|---------------------------------|---------------------------------|
| `chmod 777 ~/.ssh`             | –õ—é–±–æ–π –º–æ–∂–µ—Ç —É–∫—Ä–∞—Å—Ç—å –∫–ª—é—á–∏       |
| –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –∫–ª—é—á –≤–µ–∑–¥–µ    | –ö–æ–º–ø—Ä–æ–º–∞—Ç –æ–¥–Ω–æ–≥–æ = –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º |
| –•—Ä–∞–Ω–∏—Ç—å –∫–ª—é—á–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏     | GitHub —Å–∫–∞–Ω–∏—Ä—É–µ—Ç `.env` –∏ `.ssh` |

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: —á—Ç–æ –¥–µ–ª–∞—Ç—å —Å –∫–ª—é—á–∞–º–∏?

- **–ü–∞—Ä–æ–ª—å–Ω–∞—è —Ñ—Ä–∞–∑–∞** (–ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏):
  ```bash
  ssh-keygen -t ed25519 -C "email" -f ~/.ssh/project_deploy -N "my_strong_passphrase"
  ```
- **SSH-–∞–≥–µ–Ω—Ç** (—á—Ç–æ–±—ã –Ω–µ –≤–≤–æ–¥–∏—Ç—å —Ñ—Ä–∞–∑—É –∫–∞–∂–¥—ã–π —Ä–∞–∑):
  ```bash
  eval "$(ssh-agent -s)"
  ssh-add ~/.ssh/id_ed25519
  ```

---

## üßæ –í—ã–≤–æ–¥

**SSH ‚Äî —ç—Ç–æ –Ω–µ —Å—Ç—Ä–∞—à–Ω–æ.**  
3 –∫–æ–º–∞–Ω–¥—ã ‚Äî –∏ —Ç—ã –∏–∑–±–∞–≤–∏–ª—Å—è –æ—Ç –ø–∞—Ä–æ–ª–µ–π, –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ –∏ –Ω–µ—Ä–≤–Ω—ã—Ö –≤–≤–æ–¥–æ–≤ `sudo su`
