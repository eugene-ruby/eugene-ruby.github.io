---
layout: post
subtitle: <div id="terminal"></div>
title:  "Ruby 3.0 ‚Üí 3.4: —á—Ç–æ –¥–æ–±–∞–≤–∏–ª–∏, —á—Ç–æ —É–±—Ä–∞–ª–∏, —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å"
date:   2025-03-10 11:30:00 +0300
rate: 3
tags: Ruby,Rails,PostgreSQL,DevOps,Ractor,Pattern Matching
version: A49X3
categories:
  - performance
  - ruby
toc: true
menubar_toc: true
hero_image: /images/ruby.jpg
hero_darken: true
---
Ruby –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è, –ø—Ä–µ–¥–ª–∞–≥–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –Ω–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–æ–º, —É–ª—É—á—à–µ–Ω–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —É–¥–æ–±–Ω—ã–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏. –í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≤–µ—Ä—Å–∏—è—Ö Ruby 3.x, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –≤–∞–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —è–∑—ã–∫ –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö —Å Rails, PostgreSQL –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ DevOps-–ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏.

---

Ruby 3.x ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–ø–¥–µ–π—Ç. –≠—Ç–æ —ç–≤–æ–ª—é—Ü–∏—è —è–∑—ã–∫–∞: –æ—Ç —É–ª—É—á—à–µ–Ω–∏–π –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–æ –Ω–æ–≤—ã—Ö —Ñ–∏—á —Ç–∏–ø–∞ `Ractor`, `Pattern Matching`, `Data` –∏ `Fiber.schedule`.

–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ ‚Äî **—à–ø–∞—Ä–≥–∞–ª–∫–∞** –ø–æ –≤–µ—Ä—Å–∏—è–º Ruby –æ—Ç 3.0 –¥–æ 3.4: –±–µ–∑ –≤–æ–¥—ã, —Ç–æ–ª—å–∫–æ —Ñ–∞–∫—Ç—ã.

## üßæ Ruby 3.0 (–¥–µ–∫–∞–±—Ä—å 2020)

üéØ **–¶–µ–ª—å: Ruby 3x3** ‚Äî –≤ 3 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º Ruby 2.0

### üîπ –ì–ª–∞–≤–Ω–æ–µ:
- üí¨ **Ractor** ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º
- üî• **Fiber Scheduler API** ‚Äî —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è async/await
- üì¶ **Pattern Matching** —Å—Ç–∞–ª —Å—Ç–∞–±–∏–ª—å–Ω—ã–º (–∏–∑ 2.7)
- ‚è±Ô∏è –£–ª—É—á—à–µ–Ω–∏—è JIT (MJIT)
- ‚úÖ `...` —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ –º–µ—Ç–æ–¥–∞—Ö

---

## ‚öôÔ∏è Ruby 3.1 (–¥–µ–∫–∞–±—Ä—å 2021)

### üîπ –ì–ª–∞–≤–Ω–æ–µ:
- üí† **`Data` –∫–ª–∞—Å—Å** ‚Äî –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Struct, –º–∏–Ω–∏–º–∞–ª–µ–Ω:
  ```ruby
  Point = Data.define(:x, :y)
````

* üì¶ `Enumerable#tally` ‚Üí —á–∞—Å—Ç–æ—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑
* üß™ **Experimental: `debug` gem** ‚Äî –¥–µ–±–∞–≥–≥–µ—Ä –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è
* üß± MJIT ‚Üí Rewrite –Ω–∞ C
* üìõ Deprecation: `lambda.call(...)` –±–µ–∑ —Å–∫–æ–±–æ–∫ —Ç–µ–ø–µ—Ä—å –≤—ã–∑—ã–≤–∞–µ—Ç warning

---

## üß∞ Ruby 3.2 (–¥–µ–∫–∞–±—Ä—å 2022)

### üîπ –ì–ª–∞–≤–Ω–æ–µ:

* üîí **Immutable `Data` —Ç–µ–ø–µ—Ä—å "shareable" –¥–ª—è Ractor**
* ‚öôÔ∏è **YJIT** —Å—Ç–∞–ª —Å—Ç–∞–±–∏–ª—å–Ω—ã–º –∏ –≤–∫–ª—é—á–∞–µ–º—ã–º –∏–∑ –∫–æ—Ä–æ–±–∫–∏
* üßµ `Thread#join` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `self`
* üí¨ `Regexp#match?` ‚Üí –±—ã—Å—Ç—Ä–µ–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ
* üö´ –£–¥–∞–ª–µ–Ω—ã: `Time#to_time`, `Time#getlocal(arg)` –∏ –¥—Ä—É–≥–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ API

---

## üöÄ Ruby 3.3 (–¥–µ–∫–∞–±—Ä—å 2023)

### üîπ –ì–ª–∞–≤–Ω–æ–µ:

* ‚öôÔ∏è **YJIT –≤–∫–ª—é—á—ë–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** (–Ω–∞ Linux/macOS)
* üì¶ **Gemified stdlib** ‚Äî –º–Ω–æ–≥–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –±–æ–ª—å—à–µ –Ω–µ –≤—Å—Ç—Ä–æ–µ–Ω—ã, –∞ —Å—Ç–∞–≤—è—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ (`net/http`, `uri`, `csv`, –∏ —Ç.–¥.)
* üßº `Dir.children`, `Dir.each_child` —Å—Ç–∞–ª–∏ –±—ã—Å—Ç—Ä–µ–µ
* üß† `SyntaxError` —Ç–µ–ø–µ—Ä—å –≤—ã–≤–æ–¥–∏—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ "unexpected end"
* üö´ –£–¥–∞–ª–µ–Ω–æ: `Proc.new &block` (—É—Å—Ç–∞—Ä–µ–≤—à–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ)

---

## üî¨ Ruby 3.4 (–¥–µ–∫–∞–±—Ä—å 2024)

### üîπ –ì–ª–∞–≤–Ω–æ–µ:

* ‚öôÔ∏è **Ractor —É–ª—É—á—à–µ–Ω**:

    * `Ractor.make_shareable`
    * `Ractor::MovedObject` —Ç–µ–ø–µ—Ä—å –º–µ–Ω—å—à–µ –ø—É–≥–∞–µ—Ç
* üìà **YJIT —É–ª—É—á—à–µ–Ω** (–µ—â–µ –º–µ–Ω—å—à–µ –ø—Ä–æ–≥—Ä–µ–≤–∞)
* üì¶ **New stdlib layout**:

    * core, default, bundled, gems
    * –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á–µ—Ä–µ–∑ `Gem::Specification`
* üßÉ `Array#intersect?`, `Hash#except`, `Object#with` ‚Äî —É–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã
* üö´ `Enumerator::Chain` —á–∞—Å—Ç–∏—á–Ω–æ –∑–∞–º–µ–Ω—ë–Ω `Enumerable#chain`

---

## üí° –û–±—â–∏–µ —Ç—Ä–µ–Ω–¥—ã Ruby 3.x

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è          | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ                             |
| ------------------ | --------------------------------------- |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | MJIT, YJIT, Fiber.schedule              |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å       | Ractor, shareable objects               |
| –°–∏–Ω—Ç–∞–∫—Å–∏—Å          | Pattern Matching, endless method def    |
| –£–¥–∞–ª–µ–Ω–∏—è           | –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ API, implicit block handling |
| –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è     | –ë–æ–ª—å—à–µ "–≥–µ–º–æ—Ñ–∏–∫–∞—Ü–∏–∏" stdlib             |

---

üîö **–í—ã–≤–æ–¥:**
Ruby 3.x ‚Äî —ç—Ç–æ –±–æ–ª—å—à–µ, —á–µ–º "–Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è". –≠—Ç–æ –¥–≤–∏–∂–µ–Ω–∏–µ –≤ —Å—Ç–æ—Ä–æ–Ω—É —Ä–µ–∞–ª—å–Ω–æ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏, —É–¥–æ–±—Å—Ç–≤–∞ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏.
–î–∞, —á—Ç–æ-—Ç–æ –æ—Ç—Ä–µ–∑–∞–ª–∏. –ù–æ –¥–æ–±–∞–≤–∏–ª–∏ –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ ‚Äî –∏ –≤—Å—ë —ç—Ç–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–∂–µ —Å–µ–≥–æ–¥–Ω—è.
