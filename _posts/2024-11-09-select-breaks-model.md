---
layout: post
subtitle: <div id="terminal"></div>
title:  "–ü–æ—á–µ–º—É select(\"...\") –ª–æ–º–∞–µ—Ç –º–µ—Ç–æ–¥—ã –º–æ–¥–µ–ª–∏ –≤ Rails"
date:   2024-11-09 11:00:00 +0300
rate: 3
tags: Ruby,PostgreSQL,Rails,DevOps,–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤,–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
version: 3.2.2
categories:
  - rails
toc: true
menubar_toc: true
hero_image: /images/posts/47.jpg
hero_darken: true
---
Ruby, PostgreSQL –∏ Rails ‚Äî –º–æ—â–Ω—ã–π —Å—Ç–µ–∫ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –∞ DevOps-–ø—Ä–∞–∫—Ç–∏–∫–∏ –ø–æ–º–æ–≥–∞—é—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞—Ç—å –∏—Ö –±—ã—Å—Ç—Ä–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ. –í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —Ä–∞–∑–±–µ—Ä—ë–º –∫–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–ª—è Ruby on Rails –ø—Ä–æ–µ–∫—Ç–æ–≤.

---
–¢—ã –≤—ã–∑—ã–≤–∞–µ—à—å `user.name`, –∞ –ø–æ–ª—É—á–∞–µ—à—å `nil` ‚Äî —Ö–æ—Ç—è –≤ –±–∞–∑–µ –≤—Å—ë –µ—Å—Ç—å. –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∏—Ä `.select("...")`.

## üòµ –ü—Ä–æ–±–ª–µ–º–∞

```ruby
User.select("id").first.name
# => nil
````

–ü–æ—á–µ–º—É? –ü–æ—Ç–æ–º—É —á—Ç–æ `ActiveRecord` —Å–æ–∑–¥–∞—ë—Ç –º–æ–¥–µ–ª—å, –≤ –∫–æ—Ç–æ—Ä–æ–π **–Ω–µ—Ç –ø–æ–ª—è `name`**, —Ç—ã –µ–≥–æ –Ω–µ –≤—ã–±–∏—Ä–∞–ª.

---

## ü§ñ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç ActiveRecord

–ö–æ–≥–¥–∞ —Ç—ã –¥–µ–ª–∞–µ—à—å:

```ruby
User.select("id").first
```

Rails —Å–æ–∑–¥–∞—ë—Ç –æ–±—ä–µ–∫—Ç `User`, –Ω–æ –≤ `attributes` ‚Äî —Ç–æ–ª—å–∫–æ `id`. –û—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã (`name`, `email`, `created_at`) –ø—Ä–æ—Å—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç.

---

## üí• –ê –µ—Å–ª–∏ —Ç—ã –≤—ã–∑–æ–≤–µ—à—å `user.name`?

```ruby
user.name # => nil
user.attributes # => { "id" => 1 }
```

–ú–µ—Ç–æ–¥ `#name` –Ω–µ —É–ø–∞–ª —Å –æ—à–∏–±–∫–æ–π ‚Äî –Ω–æ –≤–µ—Ä–Ω—É–ª `nil`, –ø–æ—Ç–æ–º—É —á—Ç–æ –∞—Ç—Ä–∏–±—É—Ç –≤–æ–æ–±—â–µ –Ω–µ –±—ã–ª –∑–∞–≥—Ä—É–∂–µ–Ω.

---

## ‚úÖ –ö–∞–∫ –Ω–µ —Å–ª–æ–º–∞—Ç—å –º–æ–¥–µ–ª—å

–í—ã–±–∏—Ä–∞–π –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è —è–≤–Ω–æ:

```ruby
User.select(:id, :name).first.name
# => —Ä–∞–±–æ—Ç–∞–µ—Ç!
```

–õ–∏–±–æ –∏—Å–ø–æ–ª—å–∑—É–π `pluck`, –µ—Å–ª–∏ —Ç–µ–±–µ –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ:

```ruby
User.pluck(:name)
```

---

## üìå –ó–∞–ø–æ–º–Ω–∏

| –°–∏—Ç—É–∞—Ü–∏—è                          | –ü–æ–≤–µ–¥–µ–Ω–∏–µ                    |
| --------------------------------- | ---------------------------- |
| `.select("id")`                   | –ù–µ—Ç –¥—Ä—É–≥–∏—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤         |
| `.select(:id, :name)`             | –¢–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç    |
| `.pluck(:id)`                     | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –∑–Ω–∞—á–µ–Ω–∏–π   |
| `.first.name` –±–µ–∑ `name` –≤ select | `nil`, –±–µ–∑ –æ—à–∏–±–∫–∏, –Ω–æ –æ–ø–∞—Å–Ω–æ |

---

`select("...")` –∏—Å–ø–æ–ª—å–∑—É—é—Ç, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å, –∫–∞–∫–∏–µ –ø–æ–ª—è –∏–∑–≤–ª–µ–∫–∞—Ç—å –∏–∑ –±–∞–∑—ã ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ –∏–ª–∏ –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –∞–≥—Ä–µ–≥–∞—Ç–æ–≤ –∏ –∞–ª–∏–∞—Å–æ–≤ (`select("users.id, COUNT(posts.id) as posts_count")`). –≠—Ç–æ –¥–∞—ë—Ç –≥–∏–±–∫–æ—Å—Ç—å –∏ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ë–î, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–º–Ω–∏—Ç—å: —Ç—ã –æ—Ç–∫–ª—é—á–∞–µ—à—å –º–∞–≥–∏—é ActiveRecord –∏ –±–µ—Ä—ë—à—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–±—ä–µ–∫—Ç–∞ –Ω–∞ —Å–µ–±—è.

üß† **–ì–ª–∞–≤–Ω—ã–π –≤—ã–≤–æ–¥**: `select("...")` –¥–∞—ë—Ç –º–æ—â—å, –Ω–æ –æ—Ç–∫–ª—é—á–∞–µ—Ç –º–∞–≥–∏—é ActiveRecord.
–ï—Å–ª–∏ –Ω–µ –≤—ã–±—Ä–∞–ª –ø–æ–ª–µ ‚Äî –∑–∞–±—É–¥—å –ø—Ä–æ –µ–≥–æ –º–µ—Ç–æ–¥—ã.
