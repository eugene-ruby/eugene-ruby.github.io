---
layout: post
subtitle: <div id="terminal"></div>
title: "Hotwire, Turbo –∏ Stimulus: frontend –±–µ–∑ JS-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ (–ø–æ—á—Ç–∏)"
date:   2024-09-20 12:00:00 +0300
rate: 2
tags: Ruby on Rails, Hotwire, Turbo, Stimulus, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, JS, frontend, javascript
version: A49X3
categories:
  - frontend
  - rails
hero_image: /images/rails.jpg
hero_darken: true
toc: true
menubar_toc: true
---
Hotwire, Turbo –∏ Stimulus ‚Äî —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É –≤ Rails-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ—á—Ç–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç —Ç—è–∂–µ–ª—ã—Ö JS-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤. –í —Å—Ç–∞—Ç—å–µ —Ä–∞–∑–±–µ—Ä—ë–º, –∫–∞–∫ —ç—Ç–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ, –∫–∞–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–∞—é—Ç –∏ –∫–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –≤ –≤–∞—à –ø—Ä–æ–µ–∫—Ç –±–µ–∑ –≥–æ–ª–æ–≤–Ω–æ–π –±–æ–ª–∏.

---
–í—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–∫–æ–Ω—á–∏–ª–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–≥–æ `application.js`, —É–¥–∞–ª–∏–ª–∏ 3000 —Å—Ç—Ä–æ–∫ jQuery-–∫–æ–¥–∞‚Ä¶  
–ê —Ç–µ–ø–µ—Ä—å –∫–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏—Ç ¬´–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–∞–∫ –≤ React¬ª.  
–ù–µ –ø–∞–Ω–∏–∫—É–π—Ç–µ ‚Äî **Hotwire —É–∂–µ –≤ –ø—É—Ç–∏**.

---

## ÔøΩ –ü–æ—á–µ–º—É –Ω–µ React/Vue/Angular?

–ü—Ä–æ–±–ª–µ–º—ã –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö SPA-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ Rails:

1. **–î–≤–æ–π–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞**: API (Rails) + —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (React) = 2x –∫–æ–¥–∞.
2. **SEO-–∫–æ—à–º–∞—Ä—ã**: Hydration, SSR, –º–µ—Ç–∞-—Ç–µ–≥–∏ ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –±–æ–ª—å.
3. **–°–ª–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** —Å Turbolinks, UJS, —Ñ–æ—Ä–º–∞–º–∏ Rails.

Hotwire –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç **¬´—Ç–æ–Ω–∫–∏–π –∫–ª–∏–µ–Ω—Ç¬ª**: —Å–µ—Ä–≤–µ—Ä —Ä–µ–Ω–¥–µ—Ä–∏—Ç HTML, –∞ JS –ª–∏—à—å ¬´–æ–∂–∏–≤–ª—è–µ—Ç¬ª –µ–≥–æ.

---

## üöÄ –ß—Ç–æ —Ç–∞–∫–æ–µ Hotwire?

**Hotwire (HTML Over The Wire)** ‚Äî —ç—Ç–æ –Ω–∞–±–æ—Ä —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –¥–ª—è SPA-–ø–æ–¥–æ–±–Ω–æ–≥–æ UX –±–µ–∑ —Ç–æ–Ω–Ω JavaScript:

- **Turbo**: –∑–∞–º–µ–Ω–∞ Turbolinks + –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è DOM.
- **Stimulus**: –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π JS-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
- **Strada** (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ): –º–æ–±–∏–ª—å–Ω—ã–µ –Ω–∞—Ç–∏–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã.

–†–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É:  
**¬´–°–µ—Ä–≤–µ—Ä —Ä–µ–Ω–¥–µ—Ä–∏—Ç HTML ‚Üí JS –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è¬ª**.

---

## üåÄ Turbo: –¥–≤–∏–≥–∞—Ç–µ–ª—å Hotwire

### Turbo Drive (–±—ã–≤—à–∏–π Turbolinks)
```ruby
# –í–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
# - AJAX-–∑–∞–ø—Ä–æ—Å –∑–∞ HTML
# - –ó–∞–º–µ–Ω–∞ <body>
# - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ URL
```
**–ü–ª—é—Å—ã**: –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã, –º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä.  
**–ú–∏–Ω—É—Å—ã**: –Ω—É–∂–Ω–æ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ —Å JS-–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è–º–∏.

### Turbo Frames
```html
<!-- –ß–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤ -->
<turbo-frame id="messages">
  <%= render @messages %>
</turbo-frame>

<!-- –°—Å—ã–ª–∫–∞ –æ–±–Ω–æ–≤–∏—Ç —Ç–æ–ª—å–∫–æ —ç—Ç–æ—Ç —Ñ—Ä–µ–π–º -->
<%= link_to "–û–±–Ω–æ–≤–∏—Ç—å", messages_path, data: { turbo_frame: "messages" } %>
```
**–ò–¥–µ–∞–ª—å–Ω–æ** –¥–ª—è: —Ñ–∏–ª—å—Ç—Ä–æ–≤, –≤–∫–ª–∞–¥–æ–∫, –ª–∞–π–≤-–ø–æ–∏—Å–∫–∞.

### Turbo Streams
```ruby
# –í –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ:
respond_to do |format|
  format.turbo_stream # –ò—â–µ—Ç —à–∞–±–ª–æ–Ω `create.turbo_stream.erb`
end
```
–®–∞–±–ª–æ–Ω:
```erb
<!-- –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å–ø–∏—Å–æ–∫ -->
<%= turbo_stream.append "messages", @message %>

<!-- –í–∞—Ä–∏–∞–Ω—Ç—ã –¥–µ–π—Å—Ç–≤–∏–π: append/prepend/replace/remove -->
```
**–≠—Ç–æ –∫–∞–∫ ActionCable**, –Ω–æ –±–µ–∑ WebSocket-–æ–≤ (–µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ).

---

## üéõ Stimulus: JS –¥–ª—è –ª–µ–Ω–∏–≤—ã—Ö

–ö–æ–≥–¥–∞ Turbo –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç ‚Äî –ø–æ–¥–∫–ª—é—á–∞–µ–º **Stimulus**:

```js
// app/javascript/controllers/search_controller.js
import { Controller } from "@hotwired/stimulus"

export default class extends Controller {
  static targets = ["input", "results"]

  search() {
    fetch(`/search?q=${this.inputTarget.value}`)
      .then(response => response.text())
      .then(html => this.resultsTarget.innerHTML = html)
  }
}
```

–ü–æ–¥–∫–ª—é—á–∞–µ–º –≤ HTML:
```html
<div data-controller="search">
  <input data-search-target="input" data-action="input->search#search">
  <div data-search-target="results"></div>
</div>
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –ª—É—á—à–µ jQuery?**  
- –ß—ë—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã ‚Üí –¥–µ–π—Å—Ç–≤–∏—è ‚Üí —Ç–∞—Ä–≥–µ—Ç—ã).  
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏.  
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Webpack/ESM.

---

## üß© –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω—ã

### 1. ¬´–¢—É—Ä–±–æ-–∞–¥¬ª (Turbo Overuse)
```erb
<!-- –ü–ª–æ—Ö–æ: –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Ñ—Ä–µ–π–º—ã + streams + JS -->
<turbo-frame id="user">
  <turbo-frame id="posts">
    <!-- ... -->
  </turbo-frame>
</turbo-frame>
```
**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Turbo —Ç–æ–ª—å–∫–æ —Ç–∞–º, –≥–¥–µ —ç—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç UX.

### 2. ¬´–°—Ç–∏–º—å—é–ª–∏—â–µ¬ª (Stimulus as React)
```js
// –ü–ª–æ—Ö–æ: —Ç–∞—â–∏—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ data-–∞—Ç—Ä–∏–±—É—Ç—ã
this.element.dataset.page = 2
```
**–†–µ—à–µ–Ω–∏–µ**: Stimulus ‚Äî –¥–ª—è –º–∞–ª—ã—Ö –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π. –î–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è ‚Äî JSON API + Alpine.js.

### 3. –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è
```ruby
# –ü–ª–æ—Ö–æ: —Ñ–æ—Ä–º–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ JS
<%= form_with(model: @post, data: { turbo: false }) %>
```
**–†–µ—à–µ–Ω–∏–µ**: –í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π—Ç–µ fallback –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.

---

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Rails

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
bundle add hotwire-rails
rails hotwire:install
```
–≠—Ç–æ –¥–æ–±–∞–≤–∏—Ç:
- Turbo + Stimulus –≤ `importmap.rb` (–∏–ª–∏ Webpack).  
- –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ Stimulus.  
- –®–∞–±–ª–æ–Ω—ã –¥–ª—è `turbo_stream.erb`.

### 2. –†–∞–±–æ—Ç–∞ —Å —Ñ–æ—Ä–º–∞–º–∏
```ruby
# –§–æ—Ä–º–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π Turbo Stream
<%= form_with(model: @post, format: :turbo_stream) %>
```
–°–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç –æ—Ç–≤–µ—Ç–∏—Ç—å:
```erb
<%= turbo_stream.replace "post_#{@post.id}", @post %>
```

### 3. –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
```js
// Stimulus-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –º–æ–∂–µ—Ç —Å–ª—É—à–∞—Ç—å Turbo-—Å–æ–±—ã—Ç–∏—è:
this.element.addEventListener("turbo:submit-end", (event) => {
  if (event.detail.success) {
    this.showConfirmation()
  }
})
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å Turbo
```ruby
test "create post with Turbo Stream" do
  post posts_path, params: { post: { title: "New" } }, as: :turbo_stream

  assert_turbo_stream action: "append", target: "posts"
end
```

### –¢–µ—Å—Ç—ã Stimulus-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
```js
import { Application } from "@hotwired/stimulus"
import SearchController from "./search_controller"

describe("SearchController", () => {
  beforeEach(() => {
    document.body.innerHTML = `
      <div data-controller="search">
        <input data-search-target="input">
        <div data-search-target="results"></div>
      </div>
    `
    const application = Application.start()
    application.register("search", SearchController)
  })

  it("updates results on input", () => {
    // ...
  })
})
```

---

## üé§ –ß—Ç–æ —Å–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏

> ‚Äî –ü–æ—á–µ–º—É –≤—ã –≤—ã–±—Ä–∞–ª–∏ Hotwire –≤–º–µ—Å—Ç–æ React?

‚Äî –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ CRUD-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ Hotwire –¥–∞—ë—Ç 90% UX SPA —Å 10% —Å–ª–æ–∂–Ω–æ—Å—Ç–∏. –ú—ã —ç–∫–æ–Ω–æ–º–∏–º –≤—Ä–µ–º—è –Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –ø–æ–ª—É—á–∞–µ–º SEO ¬´–∏–∑ –∫–æ—Ä–æ–±–∫–∏¬ª.

---

## üßæ –í—ã–≤–æ–¥

**Hotwire ‚Äî —ç—Ç–æ ¬´–∑–æ–ª–æ—Ç–∞—è —Å–µ—Ä–µ–¥–∏–Ω–∞¬ª –º–µ–∂–¥—É MPA –∏ SPA.**  
Turbo –∑–∞–º–µ–Ω—è–µ—Ç 80% jQuery-–∫–æ–¥–∞, Stimulus –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è 19%, –∏ —Ç–æ–ª—å–∫–æ 1% ‚Äî —ç—Ç–æ –ø–æ–≤–æ–¥ —Ç—è–Ω—É—Ç—å React.  

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞ –Ω–æ–≤–æ–º –ø—Ä–æ–µ–∫—Ç–µ ‚Äî –∏ –≤–∞—à–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –ø–µ—Ä–µ—Å—Ç–∞–Ω—É—Ç –ø—Ä–æ—Å–∏—Ç—å ¬´—Å–±–æ—Ä–∫—É –Ω–∞ Webpack –∑–∞ 15 –º–∏–Ω—É—Ç¬ª.  

**–ö–æ–≥–¥–∞ Hotwire –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç:**  
- –°–ª–æ–∂–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, Figma-–ø–æ–¥–æ–±–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä).  
- –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º.  

–î–ª—è –≤—Å–µ–≥–æ –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ ‚Äî –µ—Å—Ç—å Rails ‚ô•Ô∏è Hotwire.  
