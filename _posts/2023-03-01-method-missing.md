---
layout: post
title:  "Ruby: method_missing –∏ respond_to_missing? ‚Äî –¥—Ä—É–≥ –∏–ª–∏ –≤—Ä–∞–≥?"
date:   2023-03-01 12:00:00 +0300
categories:
  - ruby
toc: true
menubar_toc: true
hero_image: /images/ruby.jpeg
hero_darken: true
---

–ú–µ—Ç–æ–¥ `method_missing` ‚Äî –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –º–∞–≥–∏—á–µ—Å–∫–∏—Ö –∏ —Å–æ–±–ª–∞–∑–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ –∞—Ä—Å–µ–Ω–∞–ª–µ Ruby-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞. –ï–≥–æ –ª—é–±—è—Ç –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è—Ö –∏ –Ω–µ–Ω–∞–≤–∏–¥—è—Ç –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.

## ü§î –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

–ö–æ–≥–¥–∞ –æ–±—ä–µ–∫—Ç—É –ø–æ—Å—ã–ª–∞—é—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ (–≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞), –∫–æ—Ç–æ—Ä–æ–≥–æ —É –Ω–µ–≥–æ –Ω–µ—Ç, Ruby –≤—ã–∑—ã–≤–∞–µ—Ç `method_missing`.

```ruby
class Ghost
  def method_missing(name, *args)
    puts "–í—ã–∑–≤–∞–Ω –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥: #{name}, args: #{args.inspect}"
  end
end

g = Ghost.new
g.hello("world")  # => –í—ã–∑–≤–∞–Ω –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥: hello, args: ["world"]
````

## ‚ö†Ô∏è –ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏

1. `method_missing` –ª–æ–≤–∏—Ç **–≤—Å–µ –æ–ø–µ—á–∞—Ç–∫–∏** ‚Äî –∏ —ç—Ç–æ –Ω–µ –≤—Å–µ–≥–¥–∞ —Ö–æ—Ä–æ—à–æ.
2. –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å `respond_to?`, –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å `respond_to_missing?`.
3. –ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç—ã IDE –∏ refactoring tools –Ω–µ –ª—é–±—è—Ç —Ç–∞–∫—É—é –º–∞–≥–∏—é.

## ‚úÖ –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ?

–ï—Å–ª–∏ —Ç—ã —Ä–µ–∞–ª–∏–∑—É–µ—à—å `method_missing`, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤—å:

```ruby
def respond_to_missing?(method_name, include_private = false)
  method_name.to_s.start_with?("ghost_") || super
end
```

–¢–æ–≥–¥–∞ `respond_to?(:ghost_scare)` –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `true`, –∏ —Ç—ã –Ω–µ –ø–æ–ª—É—á–∏—à—å –ª–∏—à–Ω–∏–π –≤–æ–ø—Ä–æ—Å –æ—Ç —Ç–µ—Ö–ª–∏–¥–∞ –Ω–∞ —Ç–µ–º—É "–ø–æ—á–µ–º—É —É —Ç–µ–±—è –≤—Å–µ–≥–¥–∞ false?".

## üìå –ö–æ–≥–¥–∞ —É–º–µ—Å—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

* –†–µ–∞–ª–∏–∑–∞—Ü–∏—è DSL (–Ω–∞–ø—Ä–∏–º–µ—Ä, ActiveRecord –∏ –µ–≥–æ `find_by_name_and_email`)
* –û–±—ë—Ä—Ç–∫–∏ –Ω–∞–¥ API —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
* –ü—Ä–æ–∫—Å–∏-–æ–±—ä–µ–∫—Ç—ã

## üôÖ –ö–æ–≥–¥–∞ –Ω–µ —Å—Ç–æ–∏—Ç?

* –î–ª—è –ª–µ–Ω–∏. –õ—É—á—à–µ —è–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Ç–æ–¥, —á–µ–º –º–∞–≥–∏—é —Ä–∞–¥–∏ –º–∞–≥–∏–∏.
* –ö–æ–≥–¥–∞ –µ—Å—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: `define_method`, `method`, `send`, `public_send`

## ü§Ø –ê –º–æ–∂–Ω–æ –ø–µ—Ä–µ–≥—Ä—É–∑–∏—Ç—å –º–µ—Ç–æ–¥, –µ—Å–ª–∏ –æ–Ω —É–∂–µ –µ—Å—Ç—å?

–ù–µ—Ç. –ï—Å–ª–∏ –º–µ—Ç–æ–¥ **—Å—É—â–µ—Å—Ç–≤—É–µ—Ç**, `method_missing` –≤—ã–∑–≤–∞–Ω –Ω–µ –±—É–¥–µ—Ç. –ï–≥–æ —Ü–µ–ª—å ‚Äî –±—ã—Ç—å "–ª–æ–≤—É—à–∫–æ–π" –¥–ª—è **–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö** –º–µ—Ç–æ–¥–æ–≤.

---

üîö –í—ã–≤–æ–¥: `method_missing` ‚Äî –∫–∞–∫ —á—ë—Ä–Ω–∞—è –º–∞–≥–∏—è. –ú–æ–≥—É—â–µ—Å—Ç–≤–µ–Ω–Ω–∞ –≤ —É–º–µ–ª—ã—Ö —Ä—É–∫–∞—Ö, –Ω–æ –ª–µ–≥–∫–æ –æ–±–µ—Ä–Ω—ë—Ç—Å—è –±–æ–ª—å—é, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑ `respond_to_missing?` –∏ –∑–¥—Ä–∞–≤–æ–≥–æ —Å–º—ã—Å–ª–∞.

