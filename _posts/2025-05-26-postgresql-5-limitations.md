---
layout: post
subtitle: <div id="terminal"></div>
title: "5 –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π PostgreSQL, –æ –∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç–æ–∏—Ç –ø–æ–º–Ω–∏—Ç—å"
date: 2025-05-26 10:00:00 +0300
rate: 3
tags: PostgreSQL,Ruby on Rails,–°–£–ë–î,–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å,DevOps,–Ω–∞—Å—Ç—Ä–æ–π–∫–∞
version: A9X
categories:
  - postgres
  - database
toc: true
menubar_toc: true
hero_image: /images/posts/92.jpg
hero_darken: true
---
PostgreSQL ‚Äî –º–æ—â–Ω–∞—è –∏ –Ω–∞–¥–µ–∂–Ω–∞—è –°–£–ë–î, –Ω–æ –¥–∞–∂–µ —É –Ω–µ—ë –µ—Å—Ç—å –Ω—é–∞–Ω—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –Ω–∞ Ruby on Rails. –í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —Ä–∞–∑–±–µ—Ä—ë–º –∫–ª—é—á–µ–≤—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è PostgreSQL, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –∞ —Ç–∞–∫–∂–µ –ø–æ–¥—Å–∫–∞–∂–µ–º, –∫–∞–∫ –∏—Ö –æ–±–æ–π—Ç–∏ —Å –ø–æ–º–æ—â—å—é DevOps-–ø—Ä–∞–∫—Ç–∏–∫ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

---
> PgBouncer ‚Äî –∫–∞–∫ –∑–∞—Ç—ã—á–∫–∞ –≤ –≤–∞–Ω–Ω—É: –ø–æ–∫–∞ —Å—Ç–æ–∏—Ç ‚Äî –≤—Å—ë –¥–µ—Ä–∂–∏—Ç—Å—è. –£–±–µ—Ä–∏ ‚Äî –∏ –±–∞–∑–∞ –∑–∞—Ö–ª–µ–±–Ω—ë—Ç—Å—è.


## 1. ‚ùå –û–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

–ö–∞–∂–¥–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–æ–∑–¥–∞—ë—Ç **–æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å**, –∞ –Ω–µ –ø–æ—Ç–æ–∫:

- –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–∏ —Ç—ã—Å—è—á–∞—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–π **PgBouncer** –≤ —Ä–µ–∂–∏–º–µ `transaction`, —á—Ç–æ–±—ã —Å–Ω–∏–∑–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É

---

## 2. üß† –û–ø–µ—Ä–∞—Ç–∏–≤–∫–∞ –Ω–∞ –∏–Ω–¥–µ–∫—Å—ã –Ω–µ –≤–µ—á–Ω–∞

PostgreSQL **–Ω–µ –∫—ç—à–∏—Ä—É–µ—Ç –∏–Ω–¥–µ–∫—Å—ã** –≤ —Å–≤–æ—ë–º —É—Ä–æ–≤–Ω–µ ‚Äî —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ **shared_buffers** –∏ **OS cache**. –ï—Å–ª–∏ –∏–Ω–¥–µ–∫—Å –Ω–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è ‚Äî —Ç–æ—Ä–º–æ–∑–∞ –Ω–µ–∏–∑–±–µ–∂–Ω—ã.

- –ü—Ä–æ–≤–µ—Ä—è–π —á–µ—Ä–µ–∑ `EXPLAIN (ANALYZE, BUFFERS)`
- –°–ª–µ–¥–∏ –∑–∞ `seq scan` –∏ `index scan` —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

---

## 3. üîì MVCC ‚Äî –Ω–µ –ø–∞–Ω–∞—Ü–µ—è

PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–º–µ—Ö–∞–Ω–∏–∑–º –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç–∏ (MVCC)**:

- –ö–∞–∂–¥–∞—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É
- –¢—Ä–µ–±—É–µ—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–∫—É—É–º–∏–∑–∞—Ü–∏—è**
- –ë–µ–∑ VACUUM —Ç–∞–±–ª–∏—Ü—ã –±—É–¥—É—Ç –ø—É—Ö–Ω—É—Ç—å, –∞ –∑–∞–ø—Ä–æ—Å—ã ‚Äî —Ç–æ—Ä–º–æ–∑–∏—Ç—å

üìå –ù–µ –æ—Ç–∫–ª—é—á–∞–π autovacuum. –ù–∏–∫–æ–≥–¥–∞.

---

## 4. üìâ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ä–∞–∑–º–µ—Ä—ã

| –û–±—ä–µ–∫—Ç          | –õ–∏–º–∏—Ç                  |
|-----------------|------------------------|
| –¢–∞–±–ª–∏—Ü–∞         | –î–æ 32 –¢–ë               |
| –°—Ç—Ä–æ–∫–∞          | –î–æ 1.6 –¢–ë              |
| –°—Ç–æ–ª–±—Ü–æ–≤        | –î–æ 1600 (—Ä–µ–∞–ª—å–Ω–æ –º–µ–Ω—å—à–µ) |
| –ò–Ω–¥–µ–∫—Å—ã         | –î–æ 32 –ø–æ–ª–µ–π            |

üìå –ï—Å–ª–∏ —á—É–≤—Å—Ç–≤—É–µ—à—å –±–æ–ª—å ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, –ø–æ—Ä–∞ –¥—É–º–∞—Ç—å –æ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏–ª–∏ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ –º–æ–¥–µ–ª–∏.

---

## 5. üß© –ù–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã—Ö materialized views

–î–∞, –æ–Ω–∏ –µ—Å—Ç—å, –Ω–æ:

- **–ù–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**
- –¢—Ä–µ–±—É—é—Ç `REFRESH MATERIALIZED VIEW`
- –ò–¥—É—Ç **–±–µ–∑ –∏–Ω–¥–µ–∫—Å–æ–≤** –¥–æ `CONCURRENTLY`

üìå –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–æ–±—ã—á–Ω—É—é —Ç–∞–±–ª–∏—Ü—É + —Ç—Ä–∏–≥–≥–µ—Ä—ã** –∏–ª–∏ CTE.

---

## üîö –í—ã–≤–æ–¥

PostgreSQL –æ—Å—Ç–∞—ë—Ç—Å—è –º–æ—â–Ω–æ–π –°–£–ë–î, –Ω–æ, –∫–∞–∫ –∏ –ª—é–±–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —Ç—Ä–µ–±—É–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π. –£—á–∏—Ç—ã–≤–∞–π –∏—Ö ‚Äî –∏ —Ç–≤–æ—è –±–∞–∑–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±—ã—Å—Ç—Ä–æ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ.
