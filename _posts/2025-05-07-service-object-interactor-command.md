---
layout: post
subtitle: <div id="terminal"></div>
title:  "Service Object, Interactor –∏ Command-–ø–æ–¥—Ö–æ–¥: –∫—Ç–æ –≤–æ —á—Ç–æ –æ–±–µ—Ä–Ω—É—Ç"
date:   2025-05-07 11:00:00 +0300
rate: 4
tags: Ruby on Rails,Service Object,Interactor,Command,–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞,—Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π
version: A9X
categories:
  - architecture
  - rails
toc: true
menubar_toc: true
hero_image: /images/architecture.jpg
hero_darken: true
---
–°–µ—Ä–≤–∏—Å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –≤ Ruby on Rails –ø–æ–º–æ–≥–∞—é—Ç –≤—ã–Ω–µ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤, –¥–µ–ª–∞—è –∫–æ–¥ —á–∏—â–µ –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–µ–µ. –í —Å—Ç–∞—Ç—å–µ —Ä–∞–∑–±–∏—Ä–∞–µ–º —Ç—Ä–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∞ ‚Äî Service Object, Interactor –∏ Command ‚Äî —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ –≤—ã–±–æ—Ä—É –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤. –£–∑–Ω–∞–π—Ç–µ, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π –≤ –≤–∞—à–µ–º Rails-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, —á—Ç–æ–±—ã —É–ø—Ä–æ—Å—Ç–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

–ö–æ–≥–¥–∞ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ —Å—Ç–∞–ª–æ —Å–ª–∏—à–∫–æ–º –¥—É—à–Ω–æ ‚Äî –Ω–∞ —Å—Ü–µ–Ω—É –≤—ã—Ö–æ–¥–∏—Ç **—Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π**.  
–ù–æ –∫–æ–≥–æ –≤—ã–±—Ä–∞—Ç—å: –ø—Ä–æ—Å—Ç–æ–π `Service Object`, –ø–∞—Ç—Ç–µ—Ä–Ω `Command` –∏–ª–∏ gem `interactor`?

## üß± Service Object

–ö–ª–∞—Å—Å —Å –æ–¥–Ω–∏–º –ø—É–±–ª–∏—á–Ω—ã–º –º–µ—Ç–æ–¥–æ–º `call`, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É. –ü—Ä–æ—Å—Ç–æ–π –∏ —á–µ—Å—Ç–Ω—ã–π:

```ruby
class RegisterUser
  def initialize(params)
    @params = params
  end

  def call
    User.create!(@params)
  end
end
````

–í—ã–∑–æ–≤: `RegisterUser.new(params).call`

---

## üßô‚Äç‚ôÇÔ∏è Interactor

–ï—Å–ª–∏ –Ω—É–∂–µ–Ω `context`, `fail!`, –∏ —Ü–µ–ø–æ—á–∫–∞ –≤—ã–∑–æ–≤–æ–≤ ‚Äî –ø–æ–º–æ–∂–µ—Ç gem [`interactor`](https://github.com/collectiveidea/interactor).

```ruby
class RegisterUser
  include Interactor

  def call
    user = User.create(context.params)
    context.fail!(error: "bad data") unless user.persisted?
    context.user = user
  end
end
```

–í—ã–∑–æ–≤: `RegisterUser.call(params: ...)`
–í —Ü–µ–ø–æ—á–∫–µ: `Organizer.call(...)`

---

## üßæ Command-–ø–æ–¥—Ö–æ–¥

–ü–æ—Ö–æ–∂ –Ω–∞ `Service`, –Ω–æ –¥–µ–ª–∞–µ—Ç —É–ø–æ—Ä –Ω–∞ **—è–≤–Ω–æ—Å—Ç—å**, **—Å–∏–≥–Ω–∞—Ç—É—Ä—É** –∏ **–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã**:

```ruby
class RegisterUser < BaseCommand
  def call
    validate_input!
    create_user!
  end
end
```

–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Å–æ–±—ã—Ç–∏—è, —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—é, –∞—É–¥–∏—Ç –∏ –ø—Ä–æ—á–∏–µ —Ä–∞–¥–æ—Å—Ç–∏ –∂–∏–∑–Ω–∏.

---

## üö¶ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

| –°—Ü–µ–Ω–∞—Ä–∏–π                           | –ü–æ–¥—Ö–æ–¥         |
| ---------------------------------- | -------------- |
| –ë—ã—Å—Ç—Ä–æ –æ–±–µ—Ä–Ω—É—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É      | Service Object |
| –•–æ—á–µ—Ç—Å—è fail! –∏ —Ü–µ–ø–æ—á–µ–∫            | Interactor     |
| –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –ª–æ–≥–≥–µ—Ä–∞–º–∏, events | Command-–ø–æ–¥—Ö–æ–¥ |

---

## üí¨ –í—ã–≤–æ–¥

–õ—é–±–æ–π –∏–∑ –ø–æ–¥—Ö–æ–¥–æ–≤ –ª—É—á—à–µ, —á–µ–º –∫–ª–∞—Å—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä.
–í—ã–±–∏—Ä–∞–π, –∏—Å—Ö–æ–¥—è –∏–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –∏ –Ω–µ –±–æ–π—Å—è –ø–∏—Å–∞—Ç—å –æ–±—ë—Ä—Ç–∫—É –Ω–∞–¥ –æ–±—ë—Ä—Ç–∫–æ–π, –µ—Å–ª–∏ —ç—Ç–æ —É–ª—É—á—à–∞–µ—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å.
