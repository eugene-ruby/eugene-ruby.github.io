---
layout: post
subtitle: <div id="terminal"></div>
title:  "Rubygems, Gemfile.lock –∏ –≤–µ—Ä—Å–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤—Å—ë —Å–ª–æ–º–∞–ª–∞"
rate: 3
tags: Ruby, bundle update, Gemfile.lock, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –æ—à–∏–±–∫–∏, Rubygems
version: A49X3
date:   2024-09-18 12:00:00 +0300
categories:
  - gems
  - ruby
hero_image: /images/ruby.jpg
hero_darken: true
toc: true
menubar_toc: true
---

–í—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–¥–µ–ª–∞–ª–∏ `bundle update`, –∏ —Ç–µ–ø–µ—Ä—å –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–µ–¥—ë—Ç —Å–µ–±—è —Ç–∞–∫, –±—É–¥—Ç–æ –µ–≥–æ –ø–∏—Å–∞–ª–∏ –Ω–∞ PHP –ø–æ—Å–ª–µ —Ç—Ä—ë—Ö –±—É—Ç—ã–ª–æ–∫ –≤–∏—Å–∫–∏. –í—Å—ë —Å–ª–æ–º–∞–Ω–æ, —Ç–µ—Å—Ç—ã –≥–æ—Ä—è—Ç, –∞ –≤ –ª–æ–≥–∞—Ö ‚Äî –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–∏–¥–µ–ª–∏. –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∞–¥ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –≥–¥–µ `Gemfile.lock` ‚Äî –≤–∞—à –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–∞—Å–∏—Ç–µ–ª—å, –∞ Rubygems ‚Äî –∫–æ–≤–∞—Ä–Ω—ã–π —Ç—Ä–æ–ª–ª—å, –ø–æ–¥–∫–ª–∞–¥—ã–≤–∞—é—â–∏–π –≥—Ä–∞–±–ª–∏.

---

## üß† –¢–µ–æ—Ä–∏—è: –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –≥–µ–º—ã –≤ Ruby

**Rubygems** ‚Äî —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–∫–µ—Ç–∞–º–∏ –¥–ª—è Ruby.  
**Bundler** ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –∫–æ—Ç–æ—Ä—ã–π:
1. –ß–∏—Ç–∞–µ—Ç `Gemfile` ("–º–Ω–µ –Ω—É–∂–Ω—ã —ç—Ç–∏ –≥–µ–º—ã –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ —Ç–∞–∫–∏—Ö –≤–µ—Ä—Å–∏—è—Ö").
2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `Gemfile.lock` ("–≤–æ—Ç —Ç–æ—á–Ω—ã–µ –≤–µ—Ä—Å–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ").
3. –ó–∞—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å–µ—Ö –∏–≥—Ä–∞—Ç—å –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º.

–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ **"–ø—Ä–∏–º–µ—Ä–Ω–æ"** ‚Äî –æ—á–µ–Ω—å —Ä–∞—Å—Ç—è–∂–∏–º–æ–µ –ø–æ–Ω—è—Ç–∏–µ.

---

## üí£ –†–µ–∞–ª—å–Ω—ã–π –∫–µ–π—Å: –∫–æ–≥–¥–∞ `~>` –∫—É—Å–∞–µ—Ç—Å—è

–î–æ–ø—É—Å—Ç–∏–º, —É –≤–∞—Å –≤ `Gemfile`:
```ruby
gem "rails", "~> 7.0.0"
```
–í—ã –¥—É–º–∞–µ—Ç–µ: "–≠—Ç–æ –∂–µ patch-–≤–µ—Ä—Å–∏–∏, –Ω–∏—á–µ–≥–æ –Ω–µ —Å–ª–æ–º–∞–µ—Ç—Å—è!".  
–ê –ø–æ—Ç–æ–º –≤—ã—Ö–æ–¥–∏—Ç Rails 7.0.4, –≥–¥–µ:
- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–ª–∏ `#pluck` –≤ `#pluck_all` (–ø–æ—Ç–æ–º—É —á—Ç–æ "—Ç–∞–∫ –ª—É—á—à–µ").
- –î–æ–±–∞–≤–∏–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Å—á–∏—Ç–∞–µ—Ç –≤–∞—à –ª–µ–≥–∞—Å–∏-–∫–æ–¥ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º.
- `ActiveRecord` —Ç–µ–ø–µ—Ä—å —Ç—Ä–µ–±—É–µ—Ç PostgreSQL 15+ (–∞ —É –≤–∞—Å –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ 13).

–ò –≤–æ—Ç –≤—ã —É–∂–µ –Ω–µ —Å–ø–∏—Ç–µ –Ω–æ—á—å—é, –≤—Å–ø–æ–º–∏–Ω–∞—è, –∑–∞—á–µ–º –≤–æ–æ–±—â–µ –∑–∞–Ω—è–ª–∏—Å—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

---

## üîß –ü—Ä–∞–∫—Ç–∏–∫–∞: –∫–∞–∫ `Gemfile.lock` —Å–ø–∞—Å–∞–µ—Ç (–∏ –ø—Ä–µ–¥–∞—ë—Ç)

**–•–æ—Ä–æ—à–∏–π `Gemfile.lock`**:
```ruby
rails (7.0.3.1)
  actioncable (= 7.0.3.1)
  actionmailer (= 7.0.3.1)
  # ... –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã
```
–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—è, —á—Ç–æ –Ω–∞ –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö ‚Äî –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –≤–µ—Ä—Å–∏–∏.

**–ü–ª–æ—Ö–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π**:
1. –í—ã —É–¥–∞–ª–∏–ª–∏ `Gemfile.lock` "–¥–ª—è —á–∏—Å—Ç–æ—Ç—ã".
2. –°–¥–µ–ª–∞–ª–∏ `bundle install` –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.
3. –ü–æ–ª—É—á–∏–ª–∏ Rails 7.1.0 —Å breaking changes.
4. –ü—Ä–æ–¥–∞–∫—à–µ–Ω —É–ø–∞–ª –≤ 9 —É—Ç—Ä–∞ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞.

---

## üíÄ –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω—ã

1. **"–û–±–Ω–æ–≤–ª—è—Ç—å –≤—Å—ë –ø–æ–¥—Ä—è–¥"**  
   ```bash
   bundle update --all # —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç –∏–≥—Ä—ã –≤ —Ä—É—Å—Å–∫—É—é —Ä—É–ª–µ—Ç–∫—É
   ```
2. **"–ó–∞–∫–æ–º–∏—á—É `Gemfile.lock` –ø–æ—Ç–æ–º"**  
   (–°–ø–æ–π–ª–µ—Ä: –≤—ã –∑–∞–±—É–¥–µ—Ç–µ, –∏ –∫–æ–ª–ª–µ–≥–∞ —Å–ª–æ–º–∞–µ—Ç CI).
3. **"–£ –º–µ–Ω—è –∂–µ —É–∫–∞–∑–∞–Ω–∞ —Ç–æ—á–Ω–∞—è –≤–µ—Ä—Å–∏—è!"**  
   ```ruby
   gem "pg", "1.5.3" # –∞ –µ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏? –æ–Ω–∏ –º–æ–≥—É—Ç –ø—Ä–∏—Ç–∞—â–∏—Ç—å –∞–¥
   ```

---

## üõ°Ô∏è –ö–∞–∫ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –±–µ–∑ –±–æ–ª–∏

1. **–õ–æ–∫–∞–ª—å–Ω–æ**:
   ```bash
   bundle update gem_name --conservative
   ```
2. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ `CHANGELOG.md`** (–µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç ‚Äî –±–µ–≥–∏—Ç–µ –æ—Ç —ç—Ç–æ–≥–æ –≥–µ–º–∞).
3. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ staging** –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º.
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `bundle outdated`** –¥–ª—è –∞—É–¥–∏—Ç–∞:
   ```bash
   $ bundle outdated
   * rails (7.0.3.1 < 7.1.0) # –∫—Ä–∞—Å–Ω—ã–π —Ñ–ª–∞–≥!
   ```

---

## üß™ –¢–µ—Å—Ç –Ω–∞ –∑—Ä–µ–ª–æ—Å—Ç—å

> ‚Äî –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–∞ –∫–æ–º–∞–Ω–¥–∞?
> ```bash
> rm Gemfile.lock && bundle install
> ```

‚Äî –õ–∏–±–æ –≤—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–ª–æ–º–∞–ª–∏ –ø—Ä–æ–µ–∫—Ç, –ª–∏–±–æ –≤–∞—à `Gemfile` –Ω–∞—Å—Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–≥–∏–π, —á—Ç–æ –≤—ã ‚Äî –π–æ–≥ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

---

## üßæ –í—ã–≤–æ–¥

1. **`Gemfile.lock` ‚Äî —Å–≤—è—â–µ–Ω–µ–Ω**. –ù–µ —É–¥–∞–ª—è–π—Ç–µ –µ–≥–æ, –Ω–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ –≤ git.
2. **–û–±–Ω–æ–≤–ª—è–π—Ç–µ—Å—å –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ**. `~>` ‚Äî –Ω–µ "–ø—Ä–∏–º–µ—Ä–Ω–æ", –∞ "—è –≥–æ—Ç–æ–≤ –∫ —Å—é—Ä–ø—Ä–∏–∑–∞–º".
3. **SemVer ‚Äî —ç—Ç–æ –º–∏—Ñ**. –í—Å–µ–≥–¥–∞ —á–∏—Ç–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π.
