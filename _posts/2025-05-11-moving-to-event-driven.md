---
layout: post
subtitle: <div id="terminal"></div>
title:  "–ö–∞–∫ –º—ã –ø–µ—Ä–µ–µ—Ö–∞–ª–∏ –Ω–∞ event-driven (–∏ –Ω–µ –ø–æ–∂–∞–ª–µ–ª–∏)"
date:   2025-05-11 12:00:00 +0300
rate: 5
tags: Ruby,—Å–æ–±—ã—Ç–∏–π–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞,pub/sub,Wisper,RailsEventStore,PostgreSQL
version: A49X3
categories:
  - architecture
  - rails
toc: true
menubar_toc: true
hero_image: /images/architecture.jpg
hero_darken: true
---
–°–æ–±—ã—Ç–∏–π–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤ Ruby-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–∑–¥–µ–ª—è—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏ —É–ø—Ä–æ—â–∞–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞. –ò—Å–ø–æ–ª—å–∑—É—è –º–µ—Ö–∞–Ω–∏–∑–º—ã pub/sub —Å –ø–æ–º–æ—â—å—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤—Ä–æ–¥–µ Wisper –∏–ª–∏ RailsEventStore, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥–∏–±–∫–∏–µ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–µ–Ω –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º –∏ —Ä–∞–±–æ—Ç–µ —Å PostgreSQL –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ DevOps.

---
–ö–æ–≥–¥–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–∞–Ω–¥ –≤ –ø—Ä–æ–µ–∫—Ç–µ –ø–µ—Ä–µ–≤–∞–ª–∏–≤–∞–µ—Ç –∑–∞ —Å–æ—Ç–Ω—é, –∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–µ—Ä–µ—Å–µ–∫–∞—Ç—å—Å—è ‚Äî –ø–æ—Ä–∞ –∑–∞–¥—É–º–∞—Ç—å—Å—è –æ **—Å–æ–±—ã—Ç–∏–π–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ**.

## üß± –î–æ: –º–æ–Ω–æ–ª–∏—Ç –∫–æ–º–∞–Ω–¥

–í—Å—ë –∑–∞–≤—è–∑–∞–Ω–æ –Ω–∞–ø—Ä—è–º—É—é:

```ruby
Order.create(...)
Analytics.track_order_created(...)
NotifyUser.call(...)
````

–ö–∞–∂–¥—ã–π —à–∞–≥ –∑–Ω–∞–µ—Ç –æ –¥—Ä—É–≥–æ–º. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π? –ü—Ä–∏–¥—ë—Ç—Å—è —Ç—Ä–æ–≥–∞—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥.

---

## üì£ –ü–æ—Å–ª–µ: –ø—É–±–ª–∏–∫—É–µ–º —Å–æ–±—ã—Ç–∏—è

–í–º–µ—Å—Ç–æ –≤—ã–∑–æ–≤–∞ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ‚Äî **–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ**:

```ruby
order = Order.create(...)
EventBus.publish('order.created', order: order)
```

–ê –ø–æ–¥–ø–∏—Å—á–∏–∫–∏ —Å–∞–º–∏ —Ä–∞–∑–±–µ—Ä—É—Ç—Å—è.

---

## üéß –ü–æ–¥–ø–∏—Å—á–∏–∫–∏

```ruby
class NotifyUserOnOrder
  def call(event)
    NotifyUser.call(order: event[:order])
  end
end

EventBus.subscribe('order.created', NotifyUserOnOrder.new)
```

---

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

* üîå –°–ª–∞–±–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ ‚Äî –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∞—Ç—å –∏ –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
* üîÑ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫)
* üöÄ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –ø–µ—Ä–µ—Ö–æ–¥ –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º

---

## üß© –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

* `Wisper` ‚Äî –ø—Ä–æ—Å—Ç–æ–π pub/sub
* `RailsEventStore` ‚Äî —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∏—Å—Ç–æ—Ä–∏–∏
* `Kafka / RabbitMQ` ‚Äî –µ—Å–ª–∏ —É—Ö–æ–¥–∏—Ç–µ –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã
* –°–≤–æ–π `EventBus` ‚Äî –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ö–≤–∞—Ç–∏—Ç –∏ –æ–±—ã—á–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞

---

## üß™ –û—Ç–ª–∞–¥–∫–∞

–í–∞–∂–Ω–æ:

* –õ–æ–≥–∏—Ä—É–π—Ç–µ —Å–æ–±—ã—Ç–∏—è
* –û–±–æ—Ä–∞—á–∏–≤–∞–π—Ç–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –≤ `rescue`
* –î–æ–±–∞–≤—å—Ç–µ retry –∏–ª–∏ DLQ (dead-letter queue)

---

## üìå –í—ã–≤–æ–¥

–°–æ–±—ã—Ç–∏—è ‚Äî —ç—Ç–æ –∫–∞–∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ Webhooks. –û–Ω–∏ –¥–µ–ª–∞—é—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –≥–∏–±—á–µ –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–µ–µ.
–ü—Ä–æ—Å—Ç–æ –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ: –ø–æ—Ä—è–¥–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω. –í–∞—à–∏ –ø–æ–¥–ø–∏—Å—á–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã**.
