---
layout: post
subtitle: <div id="terminal"></div>
title:  "–î–µ–ø–ª–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: –æ—Ç —Ä—É—á–Ω–æ–π –≤—ã–∫–∞—Ç–∫–∏ –¥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ CI/CD"
date:   2025-04-21 14:00:00 +0300
rate: 1
tags: Docker CI/CD Pet Python
version: 3.2.2
categories:
  - pet
  - docker
hero_image: /images/posts/73.jpg
hero_darken: true
toc: true
menubar_toc: true
---

–î–µ–ø–ª–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî —ç—Ç–æ –∫–∞–∫ –ø–µ—Ä–≤—ã–π –ø–æ–ª—ë—Ç –Ω–∞ —Å–∞–º–æ–ª—ë—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —Å–æ–±—Ä–∞–ª–∏ –≤ –≥–∞—Ä–∞–∂–µ: —Å—Ç—Ä–∞—à–Ω–æ, –Ω–æ –µ—Å–ª–∏ –≤—Å—ë —Å–¥–µ–ª–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚Äî –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ –ø—Ä–∏—è—Ç–Ω–æ. –í —Å—Ç–∞—Ç—å–µ —Ä–∞–∑–±–µ—Ä—ë–º, –∫–∞–∫ –ø–µ—Ä–µ–π—Ç–∏ –æ—Ç —Ä—É—á–Ω—ã—Ö –≤—ã–∫–∞—Ç–æ–∫ –∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É CI/CD –¥–∞–∂–µ –¥–ª—è pet-–ø—Ä–æ–µ–∫—Ç–æ–≤, –∏ –ø–æ—á–µ–º—É —ç—Ç–æ —Å—Ç–æ–∏—Ç —Å–¥–µ–ª–∞—Ç—å —Å—Ä–∞–∑—É, –∞ –Ω–µ "–∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å –ø–æ—Ç–æ–º".

---

## üß† –ß—Ç–æ —Ç–∞–∫–æ–µ –¥–µ–ø–ª–æ–π –∏ –∑–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω?

–î–µ–ø–ª–æ–π (–æ—Ç –∞–Ω–≥–ª. *deploy* ‚Äî —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ) ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–Ω–æ—Å–∞ –≤–∞—à–µ–≥–æ –∫–æ–¥–∞ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –≥–¥–µ –µ–≥–æ —Å–º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏.

**–ü–æ—á–µ–º—É —ç—Ç–æ –±–æ–ª—å–Ω–æ –±–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏:**
- –í—Ä—É—á–Ω—É—é –∫–æ–ø–∏—Ä—É–µ—Ç–µ —Ñ–∞–π–ª—ã –ø–æ FTP ‚Üí –∑–∞–±—ã–ª–∏ `requirements.txt`
- –ó–∞–ø—É—Å–∫–∞–µ—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã –≤—Ä—É—á–Ω—É—é ‚Üí —É–ø–∞–ª–∏ –º–∏–≥—Ä–∞—Ü–∏–∏
- –ù–µ –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ –∫–æ–¥ –ø–µ—Ä–µ–¥ –≤—ã–∫–∞—Ç–∫–æ–π ‚Üí –ø—Ä–æ–¥–∞–∫—à–Ω —É–ø–∞–ª –≤ 3 —á–∞—Å–∞ –Ω–æ—á–∏

---

## üöÄ –ü—Ä–æ—Å—Ç–µ–π—à–∏–π Flask-–ø—Ä–∏–º–µ—Ä

–ù–∞—à–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (`app.py`):

{% raw %}
```python
from flask import Flask, request, render_template_string

app = Flask(__name__)

HTML = '''
<form method="POST">
  <input name="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç">
  <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
</form>
{% if text %}
  <p>–í—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ —Ç–µ–∫—Å—Ç: {{ text }}</p>
{% endif %}
'''

@app.route('/', methods=['GET', 'POST'])
def index():
    text = request.form.get('text')
    return render_template_string(HTML, text=text)

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000)
```

`requirements.txt`:
```
Flask==3.0.0
```
{% endraw %}

---

## üê≥ –£–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –≤ Docker

**Dockerfile** ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–±–æ—Ä–∫–µ –æ–±—Ä–∞–∑–∞:

```dockerfile
FROM python:3.9-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .

CMD ["python", "app.py"]
```

**docker-compose.yml** –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:

```yaml
version: '3.8'

services:
  web:
    build: .
    ports:
      - "5000:5000"
    restart: unless-stopped
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–¥–Ω–∏–º –∫–æ–º–∞–Ω–¥–æ–π:
```bash
docker-compose up -d
```

---

## üî• –ü–æ—á–µ–º—É CI/CD –Ω—É–∂–µ–Ω –¥–∞–∂–µ –¥–ª—è pet-–ø—Ä–æ–µ–∫—Ç–∞

1. **–í—ã —É—á–∏—Ç–µ—Å—å –Ω–∞ production-grade –ø—Ä–∞–∫—Ç–∏–∫–∞—Ö**  
   –•–æ—Ç–∏—Ç–µ –≤ —Ä–µ–∑—é–º–µ "–æ–ø—ã—Ç —Å CI/CD"? –ù–∞—á–Ω–∏—Ç–µ —Å–µ–π—á–∞—Å.

2. **–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏**  
   –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π 5-–º–∏–Ω—É—Ç–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–π–º—ë—Ç 15 –º–∏–Ω—É—Ç.

3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞**  
   –¢–µ—Å—Ç—ã –∑–∞–ø—É—Å—Ç—è—Ç—Å—è —Å–∞–º–∏ –ø–µ—Ä–µ–¥ –≤—ã–∫–∞—Ç–∫–æ–π.

4. **–õ–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å**  
   –ó–∞–≤—Ç—Ä–∞ –≤–∞—à pet-–ø—Ä–æ–µ–∫—Ç –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å —Å—Ç–∞—Ä—Ç–∞–ø–æ–º.

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º CI/CD —á–µ—Ä–µ–∑ GitHub Actions

`.github/workflows/deploy.yml`:

{% raw %}
```yaml
name: Deploy to server

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Install dependencies
        run: |
          docker-compose build
          
      - name: Deploy via SSH
        uses: appleboy/ssh-action@v1.0.0
        with:
          host: ${{ secrets.SSH_HOST }}
          username: ${{ secrets.SSH_USERNAME }}
          key: ${{ secrets.SSH_KEY }}
          script: |
            cd /path/to/project
            git pull
            docker-compose down
            docker-compose up -d --build
```
{% endraw %}

**–ì–¥–µ –≤–∑—è—Ç—å —Å–µ–∫—Ä–µ—Ç—ã?**  
–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è: Settings ‚Üí Secrets ‚Üí New repository secret.

---

## üíÄ –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–µ–ø–ª–æ—è

1. **"–°–Ω–∞—á–∞–ª–∞ —Å–¥–µ–ª–∞—é, –ø–æ—Ç–æ–º –Ω–∞—Å—Ç—Ä–æ—é"**  
   –†–µ–∑—É–ª—å—Ç–∞—Ç: 50 –ø—Ä–∞–≤–æ–∫ –∏ "–∫–∞–∫ —ç—Ç–æ –≤—Å—ë —Ç–µ–ø–µ—Ä—å —Å–æ–±—Ä–∞—Ç—å?".

2. **–†—É—á–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î**  
   –ó–∞–±—ã–ª–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å ‚Äî –ø–æ–ª—É—á–∏–ª–∏ 500 –æ—à–∏–±–∫–∏.

3. **"–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –º–æ–µ–π –º–∞—à–∏–Ω–µ"**  
   –ë–µ–∑ Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è.

4. **–î–µ–ø–ª–æ–π –≤ –ø—è—Ç–Ω–∏—Ü—É –≤–µ—á–µ—Ä–æ–º**  
   –°–ø–æ–π–ª–µ—Ä: –≤—ã—Ö–æ–¥–Ω—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ—Ä—á–µ–Ω—ã.

---

## üé§ –ß—Ç–æ —Å–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏

> ‚Äî –ö–∞–∫ –≤—ã –æ—Ä–≥–∞–Ω–∏–∑—É–µ—Ç–µ –¥–µ–ø–ª–æ–π?

‚Äî –î–ª—è pet-–ø—Ä–æ–µ–∫—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é Docker + GitHub Actions. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é CI/CD —Å—Ä–∞–∑—É, —á—Ç–æ–±—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç—ã –∏ –≤—ã–∫–∞—Ç–∫—É. –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –¥–æ–±–∞–≤–ª—è—é —ç—Ç–∞–ø—ã blue-green –¥–µ–ø–ª–æ—è.

---

## üßæ –í—ã–≤–æ–¥

**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–µ–ø–ª–æ—è ‚Äî —ç—Ç–æ –Ω–µ —Ä–æ—Å–∫–æ—à—å, –∞ –≥–∏–≥–∏–µ–Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.**  
–ü–æ—Ç—Ä–∞—Ç—å—Ç–µ 2 —á–∞—Å–∞ —Å–µ–≥–æ–¥–Ω—è, —á—Ç–æ–±—ã –Ω–µ —Ç–µ—Ä—è—Ç—å –¥–Ω–∏ –Ω–∞ "–∞ –ø–æ—á–µ–º—É –æ–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç?" –∑–∞–≤—Ç—Ä–∞. –í–∞—à –±—É–¥—É—â–∏–π —è, –∫–æ—Ç–æ—Ä—ã–π –≤ 3 —á–∞—Å–∞ –Ω–æ—á–∏ —á–∏–Ω–∏—Ç –ø—Ä–æ–¥–∞–∫—à–Ω, —Å–∫–∞–∂–µ—Ç –≤–∞–º —Å–ø–∞—Å–∏–±–æ.
